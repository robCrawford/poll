(function(r,s){function g(a){clearTimeout(a);delete h[a]}function b(a){function o(){g(c);i()?j():p||(k<e?(d&&(l=d[b++]),c=setTimeout(o,l),h[c]=0,k+=l):f())}function f(a){p=!0;g(c);a?m&&m.call():n&&n.call();m=n=c=null}function j(){f(!0)}if(!q){var i=a.test,m=a.ready,n=a.quit,d=a.intervals,b=0,l=a.frequency||250,e=a.timeout||3E4,k=0,p,c;if(d){e=0;for(a=d.length;a--;)e+=d[a]}i.quit=f;i.ready=j;o();return{quit:f,ready:j}}}var h={},q;(s||r).poll=b;b.kill=function(a){for(var b in h)g(b);q=a}})(window);
